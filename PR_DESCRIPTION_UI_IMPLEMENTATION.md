# PR: フロントエンドUI実装 - 3x3グリッドとドラッグ&ドロップ機能

## 概要
MyFavoriteAlbumsのフロントエンドUIを実装しました。3x3グリッドでアルバムを選択・配置し、ドラッグ&ドロップで位置を変更できる機能を提供します。

## 主な機能

### 1. 3x3グリッドレイアウト
- 9つのスロットでアルバムを配置
- 空のスロットには「アルバムを追加」ボタンを表示
- 選択済みアルバムにはジャケット画像、タイトル、アーティスト名を表示

### 2. アルバム検索機能
- Spotify APIを使用したアルバム検索
- 検索結果からアルバムを選択可能
- Spotify埋め込みプレーヤーで視聴可能
- プレーヤーから直接アルバムを選択可能

### 3. ドラッグ&ドロップ機能
- アルバムカード全体からドラッグ可能
- 空のスロットと既存のスロットの両方にドロップ可能
- 空のスロットへのドロップ：その位置に直接配置（他のスロットは影響を受けない）
- 既存のスロットへのドロップ：アルバムを入れ替え
- カスタム並べ替え戦略で空のスロットも考慮した正確なプレビュー位置を表示

### 4. アルバム管理機能
- アルバム変更：ホバー時に表示される「アルバム変更」ボタンで別のアルバムに置き換え
- アルバム削除：ホバー時に表示される削除ボタンでアルバムを削除
- ローカルストレージに位置情報を含めて保存・復元

### 5. レスポンシブデザイン
- スマホサイズ（375x667）に対応
- ダイアログのパディングと最大幅を調整
- タッチ操作に対応

## 技術的な実装

### 使用ライブラリ
- **React (TypeScript)**: UIコンポーネント
- **Vite**: ビルドツール
- **Tailwind CSS**: スタイリング
- **shadcn/ui**: UIコンポーネント（Button, Input, Card, Dialog, Toast）
- **@dnd-kit**: ドラッグ&ドロップ機能
- **lucide-react**: アイコン

### 主要コンポーネント

#### `AlbumGrid`
- 3x3グリッドのレイアウト管理
- ドラッグ&ドロップのコンテキスト管理
- カスタム並べ替え戦略で空のスロットも考慮

#### `AlbumSlot`
- 個別のアルバムスロット表示
- ドラッグ&ドロップのハンドリング
- ホバー時の操作ボタン表示

#### `AlbumSearch`
- Spotify APIを使用したアルバム検索
- 検索結果の表示
- Spotify埋め込みプレーヤーの統合

#### `SpotifyPlayer`
- Spotify埋め込みプレーヤーの表示
- アルバム選択機能

### カスタム並べ替え戦略
`rectSortingStrategy`の代わりに、空のスロットも考慮したカスタム並べ替え戦略を実装：
- ドラッグ中のアイテムのみtransformを適用
- 空のスロットも位置計算に含める
- `handleDragEnd`と同じロジックでプレビュー位置を計算

## 解決した問題

1. **空のスロットへのドロップ**: `useDroppable`を使用して空のスロットもドロップ可能に
2. **既存のスロットへのドロップ**: 既存のスロットにも`useDroppable`を適用
3. **プレビュー位置のずれ**: カスタム並べ替え戦略で空のスロットも考慮した位置計算
4. **全アイテムが一斉に移動**: ドラッグ中のアイテムのみtransformを適用するように修正
5. **リロード時の位置保持**: ローカルストレージに位置情報を含めて保存・復元
6. **ドラッグアニメーションの不快感**: ドラッグ確定後のアニメーションを無効化

## 動作確認項目

- [x] アルバムを検索して選択できる
- [x] 3x3グリッドにアルバムを配置できる
- [x] アルバムカード全体からドラッグできる
- [x] 空のスロットにドロップできる
- [x] 既存のスロットにドロップして入れ替えできる
- [x] アルバム変更ボタンで別のアルバムに置き換えられる
- [x] 削除ボタンでアルバムを削除できる
- [x] リロード時に位置情報が保持される
- [x] スマホサイズで正常に動作する
- [x] Spotifyプレーヤーで視聴できる
- [x] プレーヤーから直接アルバムを選択できる

## 次のステップ

- [ ] 投稿作成後の画像生成機能の統合
- [ ] 投稿一覧・詳細ページの実装
- [ ] 画像ダウンロード機能の実装

